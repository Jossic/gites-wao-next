{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\jossi\\\\Dropbox\\\\JOSSIC\\\\6-development\\\\Devs\\\\gites-wao\\\\frontend\\\\components\\\\admin\\\\lists\\\\ListMessages.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n// import { Table } from 'reactstrap';\nimport { useEffect, useState } from 'react';\nimport Link from 'next/link';\nimport { getCookie } from '../../../actions/authActions';\nimport { removeMessage } from '../../../actions/messageActions';\nimport { makeStyles } from '@material-ui/core/styles';\nimport MUIDataTable from 'mui-datatables'; // import AddBoxIcon from '@material-ui/icons/AddBox';\n\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport ReplyIcon from '@material-ui/icons/Reply';\nimport FiberNewIcon from '@material-ui/icons/FiberNew';\nimport CheckBoxIcon from '@material-ui/icons/CheckBox';\nimport CheckBoxOutlineBlankIcon from '@material-ui/icons/CheckBoxOutlineBlank';\nimport VisibilityIcon from '@material-ui/icons/Visibility';\nimport DeleteForeverIcon from '@material-ui/icons/DeleteForever';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport { withRouter } from 'next/router';\nimport MuiAlert from '@material-ui/lab/Alert';\nimport Router from 'next/router';\n\nfunction Alert(props) {\n  return __jsx(MuiAlert, _extends({\n    elevation: 6,\n    variant: \"filled\"\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 22,\n      columnNumber: 9\n    }\n  }));\n}\n\n_c = Alert;\nvar useStyles = makeStyles(function (theme) {\n  return {\n    root: {\n      width: '100%',\n      '& > * + *': {\n        marginTop: theme.spacing(2)\n      }\n    }\n  };\n});\n\nvar ListMessages = function ListMessages(_ref) {\n  _s();\n\n  var messages = _ref.messages,\n      newMessages = _ref.newMessages,\n      router = _ref.router;\n  var classes = useStyles();\n  var token = getCookie('token'); //Ajouter le delete et multiple delete\n\n  var _useState = useState({\n    open: false,\n    loading: false,\n    error: '',\n    success: '',\n    message: ''\n  }),\n      values = _useState[0],\n      setvalues = _useState[1];\n\n  var loading = values.loading,\n      success = values.success,\n      error = values.error,\n      message = values.message;\n\n  var handleClose = function handleClose(event, reason) {\n    if (reason === 'clickaway') {\n      return;\n    }\n\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      open: false\n    }));\n  };\n\n  var deleteMessage = function deleteMessage(id) {\n    setvalues(_objectSpread(_objectSpread({}, values), {}, {\n      loading: true\n    }));\n    removeMessage(id, token).then(function (data) {\n      console.log('data vaut', data);\n\n      if (data.error) {\n        setvalues(_objectSpread(_objectSpread({}, values), {}, {\n          loading: false,\n          error: true,\n          success: false\n        }));\n      } else {\n        setvalues(_objectSpread(_objectSpread({}, values), {}, {\n          open: true,\n          loading: false,\n          error: '',\n          success: true,\n          message: data.text\n        }));\n        setTimeout(function () {\n          router.reload();\n        }, 3000);\n      }\n    });\n  };\n\n  var deleteConfirm = function deleteConfirm(id) {\n    if (true) {\n      var answer = window.confirm(\"Suppression du message \".concat(id, \", \\xEAtes-vous s\\xFBr ?\"));\n\n      if (answer) {\n        deleteMessage(id);\n      }\n    }\n  };\n\n  var columns = [{\n    name: '_id',\n    label: '#',\n    options: {\n      filter: true,\n      sort: true\n    }\n  }, {\n    name: 'nom',\n    label: 'Nom',\n    options: {\n      filter: true,\n      sort: true\n    }\n  }, {\n    name: 'mail',\n    label: 'Mail',\n    options: {\n      filter: true,\n      sort: false\n    }\n  }, {\n    name: 'tel',\n    label: 'Tel',\n    options: {\n      filter: true,\n      sort: false\n    }\n  }, {\n    name: 'msg',\n    label: 'Message',\n    options: {\n      filter: true,\n      sort: false,\n      customBodyRender: function customBodyRender(value, tableMeta, updateValue) {\n        return __jsx(\"p\", {\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 13\n          }\n        }, value.substring(0, 20) + '...');\n      }\n    }\n  }, {\n    name: 'vu',\n    label: 'Non lu',\n    options: {\n      filter: true,\n      customBodyRender: function customBodyRender(value, tableMeta, updateValue) {\n        return !value && __jsx(FiberNewIcon, {\n          fontSize: \"large\",\n          style: {\n            color: 'green'\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 8\n          }\n        });\n      }\n    }\n  }, {\n    name: 'repondu',\n    label: 'Répondu',\n    options: {\n      filter: true,\n      customBodyRender: function customBodyRender(value, tableMeta, updateValue) {\n        return value ? __jsx(CheckBoxIcon, {\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 7\n          }\n        }) : __jsx(CheckBoxOutlineBlankIcon, {\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 7\n          }\n        });\n      }\n    }\n  }, {\n    name: 'Voir/Répondre',\n    options: {\n      sort: false,\n      filter: false,\n      customBodyRender: function customBodyRender(value, tableMeta, updateValue) {\n        // console.log(tableMeta.rowData);\n        return !tableMeta.rowData[6] ? __jsx(Link, {\n          href: \"/admin/messages/\".concat(tableMeta.rowData[0]),\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 7\n          }\n        }, __jsx(\"a\", {\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 8\n          }\n        }, __jsx(ReplyIcon, {\n          fontSize: \"large\",\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 9\n          }\n        }))) : __jsx(Link, {\n          href: \"/admin/messages/\".concat(tableMeta.rowData[0]),\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 7\n          }\n        }, __jsx(\"a\", {\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 8\n          }\n        }, __jsx(VisibilityIcon, {\n          fontSize: \"large\",\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 9\n          }\n        })));\n      }\n    }\n  }, {\n    name: 'Suppr',\n    options: {\n      customBodyRender: function customBodyRender(value, tableMeta, updateValue) {\n        console.log(tableMeta.rowData);\n        return __jsx(DeleteForeverIcon, {\n          style: {\n            cursor: 'pointer',\n            fontSize: '30px'\n          },\n          onClick: function onClick() {\n            return deleteConfirm(tableMeta.rowData[0]);\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 7\n          }\n        });\n      }\n    }\n  }];\n  var options = {\n    filterType: 'checkbox',\n    selectableRows: false\n  };\n  return __jsx(React.Fragment, null, loading && __jsx(CircularProgress, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 16\n    }\n  }), success && __jsx(Snackbar, {\n    open: open,\n    autoHideDuration: 6000,\n    onClose: handleClose,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 5\n    }\n  }, __jsx(Alert, {\n    onClose: handleClose,\n    severity: \"success\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 6\n    }\n  }, message)), error && __jsx(Snackbar, {\n    open: open,\n    autoHideDuration: 6000,\n    onClose: handleClose,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 5\n    }\n  }, __jsx(Alert, {\n    onClose: handleClose,\n    severity: \"error\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 6\n    }\n  }, error)), __jsx(\"p\", {\n    style: {\n      color: 'white'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 4\n    }\n  }, newMessages > 0 ? \"Vous avez \".concat(newMessages, \" non lus !\") : \"Aucun nouveau message !\"), __jsx(MUIDataTable, {\n    title: 'Messages',\n    data: messages,\n    columns: columns,\n    options: options,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 4\n    }\n  }));\n};\n\n_s(ListMessages, \"9Hua6Unv+zjI6xZP9wpCr2Ko3vc=\", false, function () {\n  return [useStyles];\n});\n\n_c2 = ListMessages;\nexport default _c3 = withRouter(ListMessages);\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"Alert\");\n$RefreshReg$(_c2, \"ListMessages\");\n$RefreshReg$(_c3, \"%default%\");","map":{"version":3,"sources":["C:/Users/jossi/Dropbox/JOSSIC/6-development/Devs/gites-wao/frontend/components/admin/lists/ListMessages.js"],"names":["useEffect","useState","Link","getCookie","removeMessage","makeStyles","MUIDataTable","CircularProgress","ReplyIcon","FiberNewIcon","CheckBoxIcon","CheckBoxOutlineBlankIcon","VisibilityIcon","DeleteForeverIcon","Snackbar","withRouter","MuiAlert","Router","Alert","props","useStyles","theme","root","width","marginTop","spacing","ListMessages","messages","newMessages","router","classes","token","open","loading","error","success","message","values","setvalues","handleClose","event","reason","setValues","deleteMessage","id","then","data","console","log","text","setTimeout","reload","deleteConfirm","answer","window","confirm","columns","name","label","options","filter","sort","customBodyRender","value","tableMeta","updateValue","substring","color","rowData","cursor","fontSize","filterType","selectableRows"],"mappings":"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","sourcesContent":["// import { Table } from 'reactstrap';\r\nimport { useEffect, useState } from 'react';\r\nimport Link from 'next/link';\r\nimport { getCookie } from '../../../actions/authActions';\r\nimport { removeMessage } from '../../../actions/messageActions';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport MUIDataTable from 'mui-datatables';\r\n// import AddBoxIcon from '@material-ui/icons/AddBox';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport ReplyIcon from '@material-ui/icons/Reply';\r\nimport FiberNewIcon from '@material-ui/icons/FiberNew';\r\nimport CheckBoxIcon from '@material-ui/icons/CheckBox';\r\nimport CheckBoxOutlineBlankIcon from '@material-ui/icons/CheckBoxOutlineBlank';\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\nimport DeleteForeverIcon from '@material-ui/icons/DeleteForever';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport { withRouter } from 'next/router';\r\nimport MuiAlert from '@material-ui/lab/Alert';\r\nimport Router from 'next/router';\r\n\r\nfunction Alert(props) {\r\n\treturn <MuiAlert elevation={6} variant='filled' {...props} />;\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n\troot: {\r\n\t\twidth: '100%',\r\n\t\t'& > * + *': {\r\n\t\t\tmarginTop: theme.spacing(2),\r\n\t\t},\r\n\t},\r\n}));\r\n\r\nconst ListMessages = ({ messages, newMessages, router }) => {\r\n\tconst classes = useStyles();\r\n\r\n\tconst token = getCookie('token');\r\n\r\n\t//Ajouter le delete et multiple delete\r\n\r\n\tconst [values, setvalues] = useState({\r\n\t\topen: false,\r\n\t\tloading: false,\r\n\t\terror: '',\r\n\t\tsuccess: '',\r\n\t\tmessage: '',\r\n\t});\r\n\r\n\tconst { loading, success, error, message } = values;\r\n\r\n\tconst handleClose = (event, reason) => {\r\n\t\tif (reason === 'clickaway') {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetValues({ ...values, open: false });\r\n\t};\r\n\r\n\tconst deleteMessage = (id) => {\r\n\t\tsetvalues({ ...values, loading: true });\r\n\t\tremoveMessage(id, token).then((data) => {\r\n\t\t\tconsole.log('data vaut', data);\r\n\t\t\tif (data.error) {\r\n\t\t\t\tsetvalues({\r\n\t\t\t\t\t...values,\r\n\t\t\t\t\tloading: false,\r\n\t\t\t\t\terror: true,\r\n\t\t\t\t\tsuccess: false,\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tsetvalues({\r\n\t\t\t\t\t...values,\r\n\t\t\t\t\topen: true,\r\n\t\t\t\t\tloading: false,\r\n\t\t\t\t\terror: '',\r\n\t\t\t\t\tsuccess: true,\r\n\t\t\t\t\tmessage: data.text,\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\trouter.reload();\r\n\t\t\t\t}, 3000);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tconst deleteConfirm = (id) => {\r\n\t\tif (typeof window !== 'undefined') {\r\n\t\t\tlet answer = window.confirm(\r\n\t\t\t\t`Suppression du message ${id}, êtes-vous sûr ?`\r\n\t\t\t);\r\n\t\t\tif (answer) {\r\n\t\t\t\tdeleteMessage(id);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\tname: '_id',\r\n\t\t\tlabel: '#',\r\n\t\t\toptions: {\r\n\t\t\t\tfilter: true,\r\n\t\t\t\tsort: true,\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'nom',\r\n\t\t\tlabel: 'Nom',\r\n\t\t\toptions: {\r\n\t\t\t\tfilter: true,\r\n\t\t\t\tsort: true,\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'mail',\r\n\t\t\tlabel: 'Mail',\r\n\t\t\toptions: {\r\n\t\t\t\tfilter: true,\r\n\t\t\t\tsort: false,\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'tel',\r\n\t\t\tlabel: 'Tel',\r\n\t\t\toptions: {\r\n\t\t\t\tfilter: true,\r\n\t\t\t\tsort: false,\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'msg',\r\n\t\t\tlabel: 'Message',\r\n\t\t\toptions: {\r\n\t\t\t\tfilter: true,\r\n\t\t\t\tsort: false,\r\n\t\t\t\tcustomBodyRender: (value, tableMeta, updateValue) => {\r\n\t\t\t\t\treturn <p>{value.substring(0, 20) + '...'}</p>;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'vu',\r\n\t\t\tlabel: 'Non lu',\r\n\t\t\toptions: {\r\n\t\t\t\tfilter: true,\r\n\t\t\t\tcustomBodyRender: (value, tableMeta, updateValue) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t!value && (\r\n\t\t\t\t\t\t\t<FiberNewIcon\r\n\t\t\t\t\t\t\t\tfontSize='large'\r\n\t\t\t\t\t\t\t\tstyle={{ color: 'green' }}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'repondu',\r\n\t\t\tlabel: 'Répondu',\r\n\t\t\toptions: {\r\n\t\t\t\tfilter: true,\r\n\t\t\t\tcustomBodyRender: (value, tableMeta, updateValue) => {\r\n\t\t\t\t\treturn value ? (\r\n\t\t\t\t\t\t<CheckBoxIcon />\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<CheckBoxOutlineBlankIcon />\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Voir/Répondre',\r\n\t\t\toptions: {\r\n\t\t\t\tsort: false,\r\n\t\t\t\tfilter: false,\r\n\t\t\t\tcustomBodyRender: (value, tableMeta, updateValue) => {\r\n\t\t\t\t\t// console.log(tableMeta.rowData);\r\n\t\t\t\t\treturn !tableMeta.rowData[6] ? (\r\n\t\t\t\t\t\t<Link href={`/admin/messages/${tableMeta.rowData[0]}`}>\r\n\t\t\t\t\t\t\t<a>\r\n\t\t\t\t\t\t\t\t<ReplyIcon fontSize='large' />\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<Link href={`/admin/messages/${tableMeta.rowData[0]}`}>\r\n\t\t\t\t\t\t\t<a>\r\n\t\t\t\t\t\t\t\t<VisibilityIcon fontSize='large' />\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Suppr',\r\n\t\t\toptions: {\r\n\t\t\t\tcustomBodyRender: (value, tableMeta, updateValue) => {\r\n\t\t\t\t\tconsole.log(tableMeta.rowData);\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<DeleteForeverIcon\r\n\t\t\t\t\t\t\tstyle={{ cursor: 'pointer', fontSize: '30px' }}\r\n\t\t\t\t\t\t\tonClick={() => deleteConfirm(tableMeta.rowData[0])}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t];\r\n\r\n\tconst options = {\r\n\t\tfilterType: 'checkbox',\r\n\t\tselectableRows: false,\r\n\t};\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{loading && <CircularProgress />}\r\n\t\t\t{success && (\r\n\t\t\t\t<Snackbar\r\n\t\t\t\t\topen={open}\r\n\t\t\t\t\tautoHideDuration={6000}\r\n\t\t\t\t\tonClose={handleClose}>\r\n\t\t\t\t\t<Alert onClose={handleClose} severity='success'>\r\n\t\t\t\t\t\t{message}\r\n\t\t\t\t\t</Alert>\r\n\t\t\t\t</Snackbar>\r\n\t\t\t)}\r\n\t\t\t{error && (\r\n\t\t\t\t<Snackbar\r\n\t\t\t\t\topen={open}\r\n\t\t\t\t\tautoHideDuration={6000}\r\n\t\t\t\t\tonClose={handleClose}>\r\n\t\t\t\t\t<Alert onClose={handleClose} severity='error'>\r\n\t\t\t\t\t\t{error}\r\n\t\t\t\t\t</Alert>\r\n\t\t\t\t</Snackbar>\r\n\t\t\t)}\r\n\t\t\t<p style={{ color: 'white' }}>\r\n\t\t\t\t{newMessages > 0\r\n\t\t\t\t\t? `Vous avez ${newMessages} non lus !`\r\n\t\t\t\t\t: `Aucun nouveau message !`}\r\n\t\t\t</p>\r\n\t\t\t<MUIDataTable\r\n\t\t\t\ttitle={'Messages'}\r\n\t\t\t\tdata={messages}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\toptions={options}\r\n\t\t\t/>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default withRouter(ListMessages);\r\n"]},"metadata":{},"sourceType":"module"}